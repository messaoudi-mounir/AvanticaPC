<?xml version="1.0" encoding="UTF-8"?>
<Flows xmlns="http://www.petrolink.com/mbe/rules">
  <Rule name="ROP Is Outside Threshold_c0902b1b-52ec-460f-b170-7633d3ea20ec" uuid="c0902b1b-52ec-460f-b170-7633d3ea20ec" well="7e09f953-1df2-4d32-8b1b-de71423c66be" wellName="Timbergrove22" ruleId="c0902b1b-52ec-460f-b170-7633d3ea20ec" ruleName="ROP Is Outside Threshold" evaluationStrategy="IndexAlignment">
    <Dependencies defaultType="buffered">
      <Channel alias="ROP" type="buffered" indexType="datetime" scope="condition" valueUnit="ft/h" indexUnit="DateTime" gap="0" id="c30ce051-368f-4b00-9938-1b567a80da1f" sequence="10" />
      <Channel alias="ROP_LOWER_THRESHOLD" type="buffered" indexType="datetime" scope="condition" valueUnit="ft/hr" indexUnit="DateTime" gap="0" id="085154dd-9c83-4fdb-9f23-4341e575f00b" sequence="20" />
      <Channel alias="ROP_UPPER_THRESHOLD" type="buffered" indexType="datetime" scope="condition" valueUnit="ft/hr" indexUnit="DateTime" gap="0" id="3cf12eeb-0a2f-411e-a327-439bd9c6ba86" sequence="30" />
      <Channel alias="rigstate" type="lastknownvalue" indexType="datetime" scope="global" indexUnit="DateTime" gap="0" id="24018315-b03b-47f5-bbc6-d2a0ff276e4e" sequence="40">
        <ValueNames>
          <Name text="Any" value="*" />
          <Name text="Cementing" value="16" />
          <Name text="Condition and/or Circulate Mud" value="7" />
          <Name text="Coring" value="6" />
          <Name text="Cut/Slip Drilling Line" value="12" />
          <Name text="Deviation Survey" value="13" />
          <Name text="Direction Work" value="25" />
          <Name text="Drill Cement and/or Float Equipment" value="20" />
          <Name text="Drill Stem Test" value="23" />
          <Name text="Drilling" value="2" />
          <Name text="Fishing" value="24" />
          <Name text="Flow check" value="31" />
          <Name text="Hole Opening" value="5" />
          <Name text="Lost Circulation" value="33" />
          <Name text="Lubricate Rig" value="10" />
          <Name text="Nipple Up/Nipple Down BOP Stack" value="21" />
          <Name text="Plug Back" value="17" />
          <Name text="Pressure Integrity Check" value="32" />
          <Name text="Reaming" value="4" />
          <Name text="Rig Up and Tear Down" value="1" />
          <Name text="Rig repair" value="11" />
          <Name text="Run Casing" value="15" />
          <Name text="Short Trip In" value="34" />
          <Name text="Short Trip Out" value="35" />
          <Name text="Squeeze Cementing" value="18" />
          <Name text="Stuck Pipe" value="27" />
          <Name text="Subsea" value="30" />
          <Name text="Test BOP" value="22" />
          <Name text="Tripping In" value="8" />
          <Name text="Tripping Out" value="9" />
          <Name text="Unknown" value="0" />
          <Name text="Wait on Cement" value="19" />
          <Name text="Wait on Weather" value="28" />
          <Name text="Well Control" value="26" />
          <Name text="Wireline Logs" value="14" />
          <Name text="Sliding" value="99" />
        </ValueNames>
      </Channel>
      <Channel alias="holedepth" type="buffered" indexType="datetime" scope="global" valueUnit="ft" indexUnit="DateTime" gap="0" id="891fdc57-92e8-47fb-9cc2-cc7b3f5d1bc2" sequence="50" />
      <Channel alias="bitdepth" type="buffered" indexType="datetime" scope="global" valueUnit="ft" indexUnit="DateTime" gap="0" id="335cd08c-de39-4dbe-98bb-81b10d0a3cfe" sequence="60" />
    </Dependencies>
    <Variables />
    <FilteringCondition />
    <Condition><![CDATA[(ROP > ROP_UPPER_THRESHOLD) || (ROP < ROP_LOWER_THRESHOLD)]]></Condition>
    <RuleActions>
      <EvaluationLog sequence="10" name="84ec1e85-cd44-41dc-803a-8c9eb766f434">
        <Channel id="84ec1e85-cd44-41dc-803a-8c9eb766f434" />
      </EvaluationLog>
    </RuleActions>
    <AlertSettings className="ROP Is Outside Threshold" class="c0902b1b-52ec-460f-b170-7633d3ea20ec">
      <ProcessingLogic type="PetrolinkAutoClear" />
      <Template>
        <Domain>Production</Domain>
        <Classification>NPT Avoidance</Classification>
        <Severity>4</Severity>
        <Priority>3</Priority>
        <Description source="static" />
        <Details contentType="json" source="context" />
        <Metadata contentType="json" source="script">
        	json.put("createdByRule", rule.getId());
        	json.put("wellId", rule.getWellId());
        	json.put("wellName", WellDirectory.getWell(rule.getWellId()).getName());
        </Metadata>
      </Template>
      <Actions>
        <OnCreateActions>
          <SendUINotification sequence="70">
            <Channel id="6327f8b6-47d7-406a-968e-7f62e8262e28" />
            <!-- This hardcoded channel id is for demo purpose and should be removed.-->
            <Group id="c76499fa-eb7d-4c68-8557-641b28cbca1e" />
            <InlineTemplate>
              <Title>ROP Is Outside Threshold</Title>
              <Body>ROP is not within Threshold!
ROP: ${ROP.value} ${ROP.valueUnit}
Upper threshold: ${ROP_UPPER_THRESHOLD.value} ${ROP_UPPER_THRESHOLD.valueUnit}
Lower threshold: ${ROP_LOWER_THRESHOLD.value} ${ROP_LOWER_THRESHOLD.valueUnit}
Rigstate: ${rigstate.valueName}</Body>
            </InlineTemplate>
          </SendUINotification>
        </OnCreateActions>
        <OnUpdateActions />
        <OnCommentActions>
          <SendUINotification sequence="80">
            <Channel id="6327f8b6-47d7-406a-968e-7f62e8262e28" />
            <!-- This hardcoded channel id is for demo purpose and should be removed.-->
            <Group id="c76499fa-eb7d-4c68-8557-641b28cbca1e" />
            <InlineTemplate>
              <Title>ROP Is Outside Threshold</Title>
              <Body>ROP is not within Threshold!
ROP: ${ROP.value} ${ROP.valueUnit}
Upper threshold: ${ROP_UPPER_THRESHOLD.value} ${ROP_UPPER_THRESHOLD.valueUnit}
Lower threshold: ${ROP_LOWER_THRESHOLD.value} ${ROP_LOWER_THRESHOLD.valueUnit}
Rigstate: ${rigstate.valueName}</Body>
            </InlineTemplate>
          </SendUINotification>
        </OnCommentActions>
        <OnAcknowledgeActions>
          <SendUINotification sequence="90">
            <Channel id="6327f8b6-47d7-406a-968e-7f62e8262e28" />
            <!-- This hardcoded channel id is for demo purpose and should be removed.-->
            <Group id="c76499fa-eb7d-4c68-8557-641b28cbca1e" />
            <InlineTemplate>
              <Title>ROP Is Outside Threshold</Title>
              <Body>ROP is not within Threshold!
ROP: ${ROP.value} ${ROP.valueUnit}
Upper threshold: ${ROP_UPPER_THRESHOLD.value} ${ROP_UPPER_THRESHOLD.valueUnit}
Lower threshold: ${ROP_LOWER_THRESHOLD.value} ${ROP_LOWER_THRESHOLD.valueUnit}
Rigstate: ${rigstate.valueName}</Body>
            </InlineTemplate>
          </SendUINotification>
        </OnAcknowledgeActions>
        <OnStatusChangeActions>
          <SendUINotification sequence="100">
            <Channel id="6327f8b6-47d7-406a-968e-7f62e8262e28" />
            <!-- This hardcoded channel id is for demo purpose and should be removed.-->
            <Group id="c76499fa-eb7d-4c68-8557-641b28cbca1e" />
            <InlineTemplate>
              <Title>ROP Is Outside Threshold</Title>
              <Body>ROP is not within Threshold!
ROP: ${ROP.value} ${ROP.valueUnit}
Upper threshold: ${ROP_UPPER_THRESHOLD.value} ${ROP_UPPER_THRESHOLD.valueUnit}
Lower threshold: ${ROP_LOWER_THRESHOLD.value} ${ROP_LOWER_THRESHOLD.valueUnit}
Rigstate: ${rigstate.valueName}</Body>
            </InlineTemplate>
          </SendUINotification>
        </OnStatusChangeActions>
        <OnJournalEntryActions>
          <EventLog sequence="110">
            <Channel id="4a6e7887-db9c-4f3c-96ac-03617d29cee0" />
          </EventLog>
        </OnJournalEntryActions>
      </Actions>
    </AlertSettings>
  </Rule>
</Flows>
